<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Remoku App Input Test</title>
<script>
var rokupostframe;
var rokuAddress = "192.168.1.10";

function rokupost(action, param){
	
	if(!rokupostframe){
	rokupostframe = document.createElement("iframe");
	rokupostframe.name="rokuresponse"
	rokupostframe.id="rokuresponse";
	rokupostframe.style.visibility="hidden";
	rokupostframe.style.display="none";
	rokupostframe = document.body.appendChild(rokupostframe);
	}
	var rokupost = document.getElementById('rokupost');
	rokupost.setAttribute("action", "http://" + rokuAddress + ":8060/" +
		action + "/" + param);
	rokupost.submit();
	//rokupost.focus();
	return false;
}

function rokulaunch(id){
	//alert (id);
	rokupost("launch",id);
	}
function clickme(){
	var textin = document.getElementById("in").value;
	var applist = document.getElementById("applist");
	if (window.DOMParser)
		{
		parser=new DOMParser();
		xmlDoc=parser.parseFromString(textin,"text/xml");
		}
	else // Internet Explorer
		{
		xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
		xmlDoc.async="false";
		xmlDoc.loadXML(textin);
		}
	var apps = xmlDoc.getElementsByTagName("app");
	for (i=0;i<apps.length;i++)
		{
		var appid = apps[i].attributes.getNamedItem("id").value;
		var appname = (apps[i].childNodes[0].nodeValue);
		//alert(appname + " " + appid);
		var appitem = document.createElement('li');
		appitem.innerHTML = "<a href='#"+appid+"' onclick='rokulaunch("+ appid +");'>" + "<img src='http://" + rokuAddress +":8060/query/icon/" + appid + "'>" +  appname + "</>";
		applist.appendChild(appitem);
		}
}
</script>
</head>
<body>
<div id="container">
<textarea id="in" style="width:120px; height:120px;"></textarea>
<button id="clickme" onclick="clickme();">Submit Apps</button>
</div>
<div id="apps">
<ul id="applist">
</ul>
</div>
<form id="rokupost" method="post" target="rokuresponse"></form>
</body>
</html>